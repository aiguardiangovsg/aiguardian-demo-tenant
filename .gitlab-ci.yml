image: python:3.11

# Global stages for the pipeline
stages:
  - scheduled

# Hourly scheduled job
hourly-task:
  stage: scheduled
  # Use GitLab's predefined schedule syntax
  rules:
    # This rule ensures the job runs every hour
    - if: $CI_PIPELINE_SOURCE == "schedule"

  # Example script (replace with your actual task)
  script:
    - echo "Running hourly task at $(date)"
    - echo "Performing maintenance or data refresh"

# Echo the current time on every branch
litmus-test-dev:
  stage: scheduled
  script:
    - python -m venv venv
    - source venv/bin/activate
    - python -m pip install --upgrade pip
    - pip install requests
    - |
      python benchmark.py \
        "$DEV_LITMUS_BASE_URL" \
        "gitlab-run" \
        "${DEV_ENDPOINT}" \
        "${TEST_SUITES:-aiguardian-baseline-tests}" \
        "${NUM_OF_PROMPTS:-5}" \
        "$DEV_LITMUS_API_KEY" \
        "${INTERVAL:-10}" \
        "${TIMEOUT:-180}"
  artifacts:
    paths:
      - litmus_test_results/
    expire_in: 1 week
  rules:
    - if: $CI_PIPELINE_SOURCE == "schedule"
